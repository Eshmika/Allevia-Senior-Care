<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <title>Client Bill of Rights - Allevia Senior Care</title>
    <style>
      body { font-family: "Inter", sans-serif; }

      /* Tailwind Polyfill for PDF Generation */
      .text-center { text-align: center; }
      .text-justify { text-align: justify; }
      .font-bold { font-weight: 700; }
      .font-semibold { font-weight: 600; }
      .text-2xl { font-size: 1.5rem; line-height: 2rem; }
      .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
      .underline { text-decoration: underline; }
      .italic { font-style: italic; }
      .mb-6 { margin-bottom: 1.5rem; }
      .mb-4 { margin-bottom: 1rem; }
      .mb-2 { margin-bottom: 0.5rem; }
      .mt-2 { margin-top: 0.5rem; }
      .mt-4 { margin-top: 1rem; }
      .mt-6 { margin-top: 1.5rem; }
      .p-8 { padding: 2rem; }
      .px-8 { padding-left: 2rem; padding-right: 2rem; }
      .py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
      .space-y-2 > * + * { margin-top: 0.5rem; }
      .list-none { list-style: none; padding: 0; margin: 0; }
      .w-full { width: 100%; }
      .border { border-width: 1px; border-style: solid; }
      .border-gray-300 { border-color: #d1d5db; }
      .rounded-md { border-radius: 0.375rem; }
      .shadow-sm { box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); }
      .p-2 { padding: 0.5rem; }
      .block { display: block; }
      .flex { display: flex; }
      .gap-3 { gap: 0.75rem; }
      .items-start { align-items: flex-start; }
      .text-red-500 { color: #ef4444; }
      .rounded-xl { border-radius: 0.75rem; }
      .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
      .min-h-screen { min-height: 100vh; }
      .bg-gray-50 { background-color: #f9fafb; }
      .py-10 { padding-top: 2.5rem; padding-bottom: 2.5rem; }
      .px-4 { padding-left: 1rem; padding-right: 1rem; }
      .mx-auto { margin-left: auto; margin-right: auto; }
      .max-w-3xl { max-width: 48rem; }
      .bg-white { background-color: #ffffff; }
      .overflow-hidden { overflow: hidden; }
      .ml-4 { margin-left: 1rem; }
      .ml-6 { margin-left: 1.5rem; }
      .space-y-1 > * + * { margin-top: 0.25rem; }
      .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
      .pt-6 { padding-top: 1.5rem; }
      .border-t-2 { border-top-width: 2px; }
      .shrink-0 { flex-shrink: 0; }
      .mt-8 { margin-top: 2rem; }
      .no-pdf { display: none; }

      /* PDF Specific Overrides */
      <? if (isPdf) { ?>
        body { background-color: white !important; padding: 0 !important; }
        .shadow-lg { box-shadow: none !important; }
        .rounded-xl { border-radius: 0 !important; }
        .no-pdf { display: none !important; }
        .pdf-value {
            border: none;
            border-bottom: 1px solid #000;
            padding: 4px 0;
            width: 100%;
            display: block;
            font-family: 'Courier New', Courier, monospace;
        }
      <? } ?>
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen py-10 px-4">
    <div
      class="max-w-3xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden"
    >
      <div class="px-8 py-6">
        <h1 class="text-2xl font-bold text-center">Client Bill of Rights</h1>
      </div>

      <div class="p-8">
        <!-- Page 1 -->
        <div id="page-1" class="mb-6">
          <section>
            <p class="text-justify mb-4">
              As a Client of Allevia llc dba Allevia Senior Care "Allevia" you
              have the right to:
            </p>

            <ol class="space-y-2 text-justify">
              <li>
                1. Obtain the name of the person supervising your care, and
                clear instructions on how that person may be contacted.
              </li>
              <li>
                2. Request that communications of protected health information
                be received by alternative means or at alternative locations.
              </li>
              <li>3. Inspect a copy of your protected health information.</li>
              <li>4. Amend your protected health information.</li>
              <li>
                5. Receive a list of the services offered by Allevia and those
                being provided to you.
              </li>
              <li>
                6. Be informed of the process of submitting and addressing
                complaints to both Allevia and Department of Health. All
                Complaints will be acted upon without retaliation to Client.
                Allevia can be reached twenty-four (24) hours a day at the
                numbers listed below:
                <div class="contact-info mt-2 ml-4">
                  <strong>Allevia (Northeast Ohio)</strong><br />
                  440-907-9599<br /><br />
                  <strong>Department of Health</strong><br />
                  614-466-3543
                </div>
              </li>
              <li>7. Participate in the development of your own Care Plan.</li>
              <li>
                8. Receive information regarding access to the Ohio State
                Department of Health's registry of Home Care providers.
                (https://publicapps.odh.ohio.gov/eid/Provider_Search.aspx)
              </li>
              <li>
                9. Have your property treated with courtesy, respect, privacy,
                and be free from abuse, neglect, and discrimination.
              </li>
              <li>10. Refuse treatment or services.</li>
              <li>
                11. Have your personal information & records confidential as
                well as accessible to you upon request.
              </li>
              <li>
                12. Be informed about advanced directives and the agency's
                responsibility to implement them.
              </li>
              <li>
                13. Receive a fully itemized billing statement at least monthly.
                Upon your request, this statement shall include the dates and
                services provided.
              </li>
              <li>
                14. Receive an evaluation of care being offered at periodic
                intervals as scheduled below or as the need may arise:
                <ul class="ml-6 mt-2 space-y-1">
                  <li>
                    a. Within seventy-two (72) hours of initiation of care.
                  </li>
                  <li>b. Second (2nd) or third (3rd) week of care.</li>
                  <li>c. Monthly evaluations thereafter.</li>
                </ul>
              </li>
              <li>
                15. In the case of any emergency situation Allevia
                employees/Contractor are instructed to call "911".
              </li>
            </ol>
          </section>
        </div>

        <!-- Page 2 -->
        <div id="page-2" class="mb-6 pt-6">
          <div class="header mb-4">
            <h2 class="font-semibold">Allevia Senior Care Duties</h2>
          </div>

          <section>
            <h3 class="font-semibold mb-4">Allevia Required to:</h3>
            <ol start="2" class="space-y-2 text-justify">
              <li>
                1. Maintain the privacy of your protected health information.
              </li>
              <li>
                2. Provide you with notice of our legal duties and privacy
                practices with respect to your protected health information.
              </li>
              <li>
                3. Provide you with access to an electronic copy of your
                protected health information, in the electronic form and format
                requested by you, if it is readily producible, or, if not
                readily producible, in an electronic form and format as agreed
                to by us and you; if you decline to accept any of the electronic
                formats readily producible by us, we must provide you a hard
                copy to fulfill your request; we may impose a reasonable
                cost-based fee to review the access request and to produce the
                electronic copy.
              </li>
              <li>
                4. Transmit a copy of protected health information, if requested
                by you, directly to another person designated by you; such a
                request must be in writing, be signed by you, and clearly
                identify the designated person and where to send the copy of the
                protected health information.
              </li>
              <li>
                5. Notify you following a breach of your unsecured protected
                health information; and
              </li>
              <li>
                6. Abide by the terms of the Notice of Privacy Practices that is
                in effect.
              </li>
            </ol>
          </section>

          <section class="mt-6 text-justify">
            <p>
              Allevia reserves the right to change the terms of this notice at
              any time and to immediately make the new notice provisions
              effective for all protected health information that it maintains.
              If the terms of this notice are materially changed, Allevia will
              promptly provide you with the revised notice by e-mail.
            </p>
          </section>
        </div>

        <!-- Signing Form -->
        <form id="billOfRightsForm" class="space-y-6 mt-8 pt-6 border-t-2">
          <div class="space-y-2">
            <? if (isPdf) { ?>
            <div class="flex gap-3 items-start">
              <span style="font-size: 18px; line-height: 1">â˜‘</span>
              <span class="italic text-sm"
                >By electronically typing or signing my name below, I
                acknowledge and agree that this electronic representation of my
                name constitutes my legal signature. This electronic signature
                has the same validity, force, and effect as a handwritten
                signature under applicable state and federal law, including the
                ESIGN Act and the Uniform Electronic Transactions Act.</span
              >
            </div>
            <? } else { ?>
            <label class="flex gap-3 items-start cursor-pointer">
              <input
                type="checkbox"
                name="agreeEsign"
                required
                class="mt-0.5 accent-[#65c027] w-4 h-4 shrink-0"
              />
              <span class="italic text-sm"
                >By electronically typing or signing my name below, I
                acknowledge and agree that this electronic representation of my
                name constitutes my legal signature. This electronic signature
                has the same validity, force, and effect as a handwritten
                signature under applicable state and federal law, including the
                ESIGN Act and the Uniform Electronic Transactions Act.</span
              >
            </label>
            <? } ?>
          </div>

          <div>
            <input type="hidden" name="clientId" value="<?= clientId ?>" />
            <label class="input-label font-semibold block mb-1"
              >Full Name <span class="text-red-500 no-pdf">*</span></label
            >
            <? if (isPdf) { ?>
            <div class="w-full border-b border-gray-400 py-2 mb-4">
              <?= [clientData.firstName, clientData.middleName, clientData.lastName].filter(Boolean).join(' ') ?>
            </div>
            <? } else { ?>
            <input
              type="text"
              name="fullName"
              class="w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 p-2 border mb-4"
              placeholder="Given Name"
              value="<?= [clientData.firstName, clientData.middleName, clientData.lastName].filter(Boolean).join(' ') ?>"
              readonly
              required
            />
            <? } ?>

            <label class="input-label font-semibold block mb-1"
              >Digital Signature (Type Full Name)<span
                class="text-red-500 no-pdf"
                >*</span
              ></label
            >
            <? if (isPdf) { ?>
            <div
              class="w-full border-b border-gray-400 py-2 mb-4"
              style="font-family: 'Courier New', Courier, monospace"
            >
              <?= clientData.Signature || '' ?>
            </div>
            <? } else { ?>
            <input
              type="text"
              name="signature"
              required
              placeholder="Type your full name"
              value="<?= clientData.Signature || '' ?>"
              class="w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 p-2 border"
            />
            <? } ?>

            <label class="input-label mt-4 block font-semibold mb-1"
              >Date <span class="text-red-500 no-pdf">*</span></label
            >
            <? if (isPdf) { ?>
            <div class="w-full border-b border-gray-400 py-2 mb-4">
              <?= clientData.SignDate || '' ?>
            </div>
            <? } else { ?>
            <input
              type="date"
              name="signDate"
              required
              value="<?= clientData.SignDate || '' ?>"
              class="w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 p-2 border"
            />
            <? } ?>
          </div>

          <div class="pt-4 no-pdf">
            <button
              type="submit"
              class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"
            >
              Sign Bill of Rights
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      // Set default date to today
      const dateInput = document.querySelector('input[name="signDate"]');
      if (dateInput && !dateInput.value) {
        dateInput.valueAsDate = new Date();
      }

      document
        .getElementById("billOfRightsForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const fullNameLower = document
            .querySelector('input[name="fullName"]')
            .value.trim()
            .replace(/\s+/g, " ")
            .toLowerCase();
          const signatureInput = document.querySelector(
            'input[name="signature"]'
          );
          const signatureRaw = signatureInput.value.trim().replace(/\s+/g, " "); // Keep original case
          const signatureLower = signatureRaw.toLowerCase();

          if (fullNameLower !== signatureLower) {
            alert("Digital Signature must match the Full Name exactly.");
            return;
          }

          const btn = e.target.querySelector('button[type="submit"]');
          const originalText = btn.innerText;
          btn.innerText = "Signing & Uploading...";
          btn.disabled = true;

          const formData = {
            clientId: document.querySelector('input[name="clientId"]').value,
            fullName: document.querySelector('input[name="fullName"]').value,
            signature: signatureRaw, // Send original case
            signDate: document.querySelector('input[name="signDate"]').value,
          };

          google.script.run
            .withSuccessHandler(function (response) {
              if (response.success) {
                const clientId = document.querySelector(
                  'input[name="clientId"]'
                ).value;
                const targetUrl =
                  "<?= scriptUrl ?>?page=client-intake-steps&id=" + clientId;

                const container = document.querySelector(".max-w-3xl");
                container.innerHTML = `
                <div class="p-10 text-center">
                  <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-green-100 flex items-center justify-center">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                  </div>
                  <h2 class="text-xl font-bold mb-2">Bill of Rights Signed</h2>
                  <p class="text-gray-600 mb-6">Thank you for signing the Client Bill of Rights.</p>
                  <a href="${targetUrl}" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700">Return to Intake Steps</a>
                </div>`;
                window.scrollTo(0, 0);
              } else {
                alert("Error: " + response.message);
                btn.innerText = originalText;
                btn.disabled = false;
              }
            })
            .withFailureHandler(function (err) {
              alert("Error: " + err);
              btn.innerText = originalText;
              btn.disabled = false;
            })
            .submitBillOfRights(formData);
        });
    </script>
  </body>
</html>
